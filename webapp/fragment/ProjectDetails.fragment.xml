<core:FragmentDefinition
    xmlns="sap.uxap"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:m="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:form="sap.ui.layout.form"
>
    <ObjectPageLayout
        id="ObjectPageLayout"
        showTitleInHeaderContent="true"
        alwaysShowContentHeader="false"
        preserveHeaderStateOnScroll="false"
        headerContentPinnable="true"
        isChildPage="true"
        upperCaseAnchorBar="false"
    >
        <headerTitle>
            <ObjectPageDynamicHeaderTitle>
                <expandedHeading>
                    <m:Title
                        text="{AppState>/oSelectedProject/ID}"
                        wrapping="true"
                        visible="false"
                    />
                </expandedHeading>
                <actions>
                    <m:Button
                        id="saveProjectDetails"
                        text="Save"
                        icon="sap-icon://save"
                        type="Critical"
                        press="onSaveProjectDetails"
                    />
                    <m:Button
                        text="Manage Roadmap"
                        id="manageRoadmap"
                        icon="sap-icon://heatmap-chart"
                        type="Critical"
                        press="onManageRoadmap"
                    />
                    <m:Button
                        icon="sap-icon://decline"
                        type="Critical"
                        press="onCloseDetailPage"
                    />
                    <m:Button
                    id="deleteProject"
                        icon="sap-icon://delete"
                        type="Critical"
                        visible="false"

                        press="onDeleteProject"
                    />
                </actions>
            </ObjectPageDynamicHeaderTitle>
        </headerTitle>

        <headerContent>
            <m:FlexBox
                wrap="Wrap"
                fitContainer="true"
                alignItems="Stretch"
            />
        </headerContent>

        <sections>
            <ObjectPageSection title="Project Details">
                <subSections>
                    <ObjectPageSubSection>
                        <blocks>
                            <form:SimpleForm
                                id="SimpleFormChange354"
                                editable="true"
                                layout="ResponsiveGridLayout"
                                labelSpanXL="3"
                                labelSpanL="3"
                                labelSpanM="3"
                                labelSpanS="12"
                                adjustLabelSpan="false"
                                emptySpanXL="4"
                                emptySpanL="4"
                                emptySpanM="4"
                                emptySpanS="0"
                                columnsXL="1"
                                columnsL="1"
                                columnsM="1"
                                singleContainerFullSize="false"
                            >
                                <form:content>
                                    <m:Label
                                        text="Project Name"
                                        required="true"
                                    />
                                    <m:Input
                                        id="pname"
                                        value="{AppState>/oSelectedProject/name}"
                                    />

                                    <m:Label text="Description" />
                                    <m:TextArea
                                        id="pdesc"
                                        value="{AppState>/oSelectedProject/description}"
                                    />

                                    <m:Label
                                        text="Initial Start Date"
                                        required="true"
                                    />
                                    <m:DatePicker
                                        id="pstart"
                                        value="{AppState>/oSelectedProject/planned_start}"
                                    />
                                    <m:Label
                                        text="Initial Finish Date"
                                        required="true"
                                    />
                                    <m:DatePicker
                                        id="pend"
                                        value="{AppState>/oSelectedProject/planned_finish}"
                                        change="onChangeDate"
                                    />
                                    <m:Label text="Currency" />
                                    <!-- <m:Input value="{AppState>/oSelectedProject/currency}" /> -->
                                    <m:ComboBox
                                        id="currency"
                                        showSecondaryValues="true"
                                        selectedKey="{AppState>/oSelectedProject/currency}"
                                        items="{
                                            path: '/Currency'
                                        }"
                                    >
                                        <core:ListItem
                                            key="{CurrencyKey}"
                                            text="{CurrencyKey}"
                                        />
                                    </m:ComboBox>

                                    <m:Label
                                        text="Project Manager"
                                        required="true"
                                    />
                                    <!-- <m:Input value="Framsys Roadmap" editable="false"/> -->
                                    <m:ComboBox
                                        id="idProjectManager"
                                        showSecondaryValues="true"
                                        selectedKey="{AppState>/oSelectedProject/projectManager_ID}"
                                        items="{
        path: '/Employee'
    }"
                                    >
                                        <core:ListItem
                                            key="{ID}"
                                            text="{name}"
                                        />
                                    </m:ComboBox>

                                    <m:Label text="Project Gatekeeper" />
                                    <!-- <m:Input value="Framsys Roadmap" editable="false"/> -->
                                    <m:ComboBox
                                        id="idProjectGateKeeper"
                                        showSecondaryValues="true"
                                        selectedKey="{AppState>/oSelectedProject/projectGateKeeper_ID}"
                                        items="{
					path: '/Employee'
				}"
                                    >
                                        <core:ListItem
                                            key="{ID}"
                                            text="{name}"
                                        />
                                    </m:ComboBox>
                                </form:content>
                            </form:SimpleForm>

                            <form:SimpleForm
                                id="SimpleFormChange"
                                editable="true"
                                layout="ResponsiveGridLayout"
                                title="Extended Project Details"
                                labelSpanXL="3"
                                labelSpanL="3"
                                labelSpanM="3"
                                labelSpanS="12"
                                adjustLabelSpan="false"
                                emptySpanXL="4"
                                emptySpanL="4"
                                emptySpanM="4"
                                emptySpanS="0"
                                columnsXL="1"
                                columnsL="1"
                                columnsM="1"
                                singleContainerFullSize="false"
                            >
                                <form:content>
                                    <m:Label
                                        text="Roadmap"
                                        visible="{= ${AppState>/oRoleBasesVisiblity/showRoadmap} || ${AppState>/oSelectedProject/isRoadmapMapped} ? false : true}"
                                    />
                                    <!-- <m:Input value="Framsys Roadmap" editable="false"/> -->
                                    <m:ComboBox
                                        visible="{= ${AppState>/oRoleBasesVisiblity/showRoadmap} || ${AppState>/oSelectedProject/isRoadmapMapped} ? false : true}"
                                        showSecondaryValues="true"
                                        id="roadmapTemplate"
                                        selectedKey="{AppState>/oSelectedProject/roadmapTemplate_ID}"
                                        items="{
					path: '/RoadmapTemplate'
				}"
                                    >
                                        <core:ListItem
                                            key="{ID}"
                                            text="{name}"
                                        />
                                    </m:ComboBox>
                                    <m:Label
                                        text="Roadmap"
                                        visible="{= ${AppState>/oSelectedProject/isRoadmapMapped} ? true : false}"
                                    />
                                    <!-- <m:Input value="Framsys Roadmap" editable="false"/> -->
                                    <m:ComboBox
                                        visible="{= ${AppState>/oSelectedProject/isRoadmapMapped} ? true : false}"
                                        showSecondaryValues="true"
                                        editable="false"
                                        id="roadmapTemplate1"
                                        selectedKey="{AppState>/oSelectedProject/roadmapTemplate_ID}"
                                        items="{
					path: '/ProjectRoadmap'
				}"
                                    >
                                        <core:ListItem
                                            key="{ID}"
                                            text="{name}"
                                        />
                                    </m:ComboBox>
                                    <m:Label text="Initial Budget" />
                                    <m:Input
                                        id="initialBudget"
                                        value="{path: 'AppState>/oSelectedProject/initialBudget',type: 'sap.ui.model.type.Float', formatOptions: { groupingEnabled: true, minFractionDigits: 0, maxFractionDigits: 0 }}"
                                        
                                        change="onBudgetChange"
                                    />

                                    <m:Label text="Forecasted Start Date" />
                                    <m:DatePicker
                                        id="fore_act_start"
                                        editable="false"
                                        value="{AppState>/oSelectedProject/fore_act_start}"
                                    />

                                    <m:Label text="Forecasted Finish Date" />
                                    <m:DatePicker
                                        id="fore_act_finish"
                                        editable="false"
                                        value="{AppState>/oSelectedProject/fore_act_finish}"
                                    />
                                    <m:Label text="Actual Start Date" />
                                    <m:DatePicker
                                        id="actualStart"
                                        editable="true"
                                        value="{AppState>/oSelectedProject/actualStart}"
                                    />
                                    <m:Label text="Actual Finish Date" />
                                    <m:DatePicker
                                        id="actualFinish"
                                        editable="true"
                                        value="{AppState>/oSelectedProject/actualFinish}"
                                    />
                                    <m:Label text="Percentage of Completion" />
                                    <m:Input
                                        value="{path: 'AppState>/oSelectedProject/pct_complete', formatter: '.formatPercentage'}"
                                        editable="false"
                                    />

                                    <m:Label text="State" />
                                    <m:Input
                                        value="{AppState>/oSelectedProject/state}"
                                        editable="false"
                                    />
                                    <m:Label text="Status" />
                                    <m:Input
                                        value="{AppState>/oSelectedProject/status}"
                                        editable="false"
                                    />
                                </form:content>
                            </form:SimpleForm>
                        </blocks>
                    </ObjectPageSubSection>

                    <ObjectPageSubSection>
                        <blocks>
                            <form:SimpleForm
                                id="DefinitionSimpleForm"
                                editable="true"
                                layout="ResponsiveGridLayout"
                                title="Definition"
                                labelSpanXL="3"
                                labelSpanL="3"
                                labelSpanM="3"
                                labelSpanS="12"
                                adjustLabelSpan="false"
                                emptySpanXL="4"
                                emptySpanL="4"
                                emptySpanM="4"
                                emptySpanS="0"
                                columnsXL="1"
                                columnsL="1"
                                columnsM="1"
                                singleContainerFullSize="false"
                            >
                                <form:content>
                                    <m:Label text="Purpose" />
                                    <m:TextArea
                                        id="purpose"
                                        value="{AppState>/oSelectedProject/purpose}"
                                        editable="true"
                                    />
                                    <m:Label text="Result" />
                                    <m:TextArea
                                        id="result"
                                        value="{AppState>/oSelectedProject/result}"
                                        editable="true"
                                    />
                                </form:content>
                            </form:SimpleForm>
                        </blocks>
                    </ObjectPageSubSection>

                    <ObjectPageSubSection
                        visible="{= ${AppState>/oSelectedProject/ID} ? true : false }"
                    >
                        <blocks>
                            <m:Table
                                id="SimpleTable11"
                                inset="false"
                                width="100%"
                                items="{AppState>/aPhase}"
                            >
                                <m:columns>
                                    <m:Column>
                                        <m:Label text="Phases" />
                                    </m:Column>
                                </m:columns>
                                <!-- Bind the items -->
                                <m:items>
                                    <m:ColumnListItem>
                                        <m:cells>
                                            <m:Text text="{AppState>name}" />
                                        </m:cells>
                                    </m:ColumnListItem>
                                </m:items>
                            </m:Table>
                        </blocks>
                    </ObjectPageSubSection>
                    <ObjectPageSubSection
                        visible="{= ${AppState>/oSelectedProject/ID} ? true : false }"
                    >
                        <blocks>
                            <m:Table
                                id="AreaTable"
                                inset="false"
                                width="100%"
                                items="{AppState>/aArea}"
                            >
                                <m:columns>
                                    <m:Column>
                                        <m:Label text="Areas" />
                                    </m:Column>
                                    <m:Column>
                                        <m:Label text="Area Leads" />
                                    </m:Column>
                                </m:columns>
                                <!-- Bind the items -->
                                <m:items>
                                    <m:ColumnListItem>
                                        <m:cells>
                                            <m:Text text="{AppState>name}" />
                                            <m:ComboBox
                                                id="idAreaLeads"
                                                showSecondaryValues="true"
                                                editable="false"
                                                selectedKey="{AppState>responsible_ID}"
                                                items="{
                                            path: '/Employee'
                                        }"
                                            >
                                                <core:ListItem
                                                    key="{ID}"
                                                    text="{name}"
                                                />
                                            </m:ComboBox>
                                        </m:cells>
                                    </m:ColumnListItem>
                                </m:items>
                            </m:Table>
                        </blocks>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
        </sections>
    </ObjectPageLayout>
</core:FragmentDefinition>